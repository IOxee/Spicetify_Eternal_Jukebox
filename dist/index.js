var eternalDjukebox=(()=>{var T=Object.create,i=Object.defineProperty,$=Object.defineProperties,j=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertyNames,r=Object.getOwnPropertySymbols,G=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,X=(e,t,a)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,z=(e,t)=>{for(var a in t=t||{})U.call(t,a)&&X(e,a,t[a]);if(r)for(var a of r(t))H.call(t,a)&&X(e,a,t[a]);return e},q=(e,t)=>$(e,P(t)),V=(e,t)=>{var a={};for(n in e)U.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&r)for(var n of r(e))t.indexOf(n)<0&&H.call(e,n)&&(a[n]=e[n]);return a},e=(e,t)=>function(){return t||(0,e[F(e)[0]])((t={exports:{}}).exports,t),t.exports},J=(t,a,n,r)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let e of F(a))U.call(t,e)||e===n||i(t,e,{get:()=>a[e],enumerable:!(r=j(a,e))||r.enumerable});return t},t=(e,t,a)=>(a=null!=e?T(G(e)):{},J(!t&&e&&e.__esModule?a:i(a,"default",{value:e,enumerable:!0}),e)),a=e({"external-global-plugin:react"(e,t){t.exports=Spicetify.React}}),W=e({"node_modules/semver/internal/debug.js"(e,t){var a="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};t.exports=a}}),Y=e({"node_modules/semver/internal/constants.js"(e,t){var a=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:a,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}}),Z=e({"node_modules/semver/internal/re.js"(e,t){var{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:r}=Y(),i=W(),o=(e=t.exports={}).re=[],s=e.safeRe=[],l=e.src=[],c=e.t={},u=0,t="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",r],[t,n]],r=(e,t,a)=>{var n=(e=>{for(var[t,a]of h)e=e.split(t+"*").join(`${t}{0,${a}}`).split(t+"+").join(`${t}{1,${a}}`);return e})(t),r=u++;i(e,r,t),c[e]=r,l[r]=t,o[r]=new RegExp(t,a?"g":void 0),s[r]=new RegExp(n,a?"g":void 0)};r("NUMERICIDENTIFIER","0|[1-9]\\d*"),r("NUMERICIDENTIFIERLOOSE","\\d+"),r("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${t}*`),r("MAINVERSION",`(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})\\.(${l[c.NUMERICIDENTIFIER]})`),r("MAINVERSIONLOOSE",`(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})\\.(${l[c.NUMERICIDENTIFIERLOOSE]})`),r("PRERELEASEIDENTIFIER",`(?:${l[c.NUMERICIDENTIFIER]}|${l[c.NONNUMERICIDENTIFIER]})`),r("PRERELEASEIDENTIFIERLOOSE",`(?:${l[c.NUMERICIDENTIFIERLOOSE]}|${l[c.NONNUMERICIDENTIFIER]})`),r("PRERELEASE",`(?:-(${l[c.PRERELEASEIDENTIFIER]}(?:\\.${l[c.PRERELEASEIDENTIFIER]})*))`),r("PRERELEASELOOSE",`(?:-?(${l[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[c.PRERELEASEIDENTIFIERLOOSE]})*))`),r("BUILDIDENTIFIER",t+"+"),r("BUILD",`(?:\\+(${l[c.BUILDIDENTIFIER]}(?:\\.${l[c.BUILDIDENTIFIER]})*))`),r("FULLPLAIN",`v?${l[c.MAINVERSION]}${l[c.PRERELEASE]}?${l[c.BUILD]}?`),r("FULL",`^${l[c.FULLPLAIN]}$`),r("LOOSEPLAIN",`[v=\\s]*${l[c.MAINVERSIONLOOSE]}${l[c.PRERELEASELOOSE]}?${l[c.BUILD]}?`),r("LOOSE",`^${l[c.LOOSEPLAIN]}$`),r("GTLT","((?:<|>)?=?)"),r("XRANGEIDENTIFIERLOOSE",l[c.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),r("XRANGEIDENTIFIER",l[c.NUMERICIDENTIFIER]+"|x|X|\\*"),r("XRANGEPLAIN",`[v=\\s]*(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:\\.(${l[c.XRANGEIDENTIFIER]})(?:${l[c.PRERELEASE]})?${l[c.BUILD]}?)?)?`),r("XRANGEPLAINLOOSE",`[v=\\s]*(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[c.XRANGEIDENTIFIERLOOSE]})(?:${l[c.PRERELEASELOOSE]})?${l[c.BUILD]}?)?)?`),r("XRANGE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAIN]}$`),r("XRANGELOOSE",`^${l[c.GTLT]}\\s*${l[c.XRANGEPLAINLOOSE]}$`),r("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),r("COERCE",l[c.COERCEPLAIN]+"(?:$|[^\\d])"),r("COERCEFULL",l[c.COERCEPLAIN]+`(?:${l[c.PRERELEASE]})?(?:${l[c.BUILD]})?(?:$|[^\\d])`),r("COERCERTL",l[c.COERCE],!0),r("COERCERTLFULL",l[c.COERCEFULL],!0),r("LONETILDE","(?:~>?)"),r("TILDETRIM",`(\\s*)${l[c.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",r("TILDE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAIN]}$`),r("TILDELOOSE",`^${l[c.LONETILDE]}${l[c.XRANGEPLAINLOOSE]}$`),r("LONECARET","(?:\\^)"),r("CARETTRIM",`(\\s*)${l[c.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",r("CARET",`^${l[c.LONECARET]}${l[c.XRANGEPLAIN]}$`),r("CARETLOOSE",`^${l[c.LONECARET]}${l[c.XRANGEPLAINLOOSE]}$`),r("COMPARATORLOOSE",`^${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]})$|^$`),r("COMPARATOR",`^${l[c.GTLT]}\\s*(${l[c.FULLPLAIN]})$|^$`),r("COMPARATORTRIM",`(\\s*)${l[c.GTLT]}\\s*(${l[c.LOOSEPLAIN]}|${l[c.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",r("HYPHENRANGE",`^\\s*(${l[c.XRANGEPLAIN]})\\s+-\\s+(${l[c.XRANGEPLAIN]})\\s*$`),r("HYPHENRANGELOOSE",`^\\s*(${l[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[c.XRANGEPLAINLOOSE]})\\s*$`),r("STAR","(<|>)?=?\\s*\\*"),r("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),r("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}}),Q=e({"node_modules/semver/internal/parse-options.js"(e,t){var a=Object.freeze({loose:!0}),n=Object.freeze({});t.exports=e=>e?"object"!=typeof e?a:e:n}}),K=e({"node_modules/semver/internal/identifiers.js"(e,t){var r=/^[0-9]+$/,a=(e,t)=>{var a=r.test(e),n=r.test(t);return a&&n&&(e=+e,t=+t),e===t?0:a&&!n||(!n||a)&&e<t?-1:1};t.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}}}),ee=e({"node_modules/semver/classes/semver.js"(e,t){var r=W(),{MAX_LENGTH:a,MAX_SAFE_INTEGER:n}=Y(),{safeRe:i,t:o}=Z(),s=Q(),l=K().compareIdentifiers,c=class{constructor(e,t){if(t=s(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;t=e.trim().match(t.loose?i[o.LOOSE]:i[o.FULL]);if(!t)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=t[4]?t[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){var t=+e;if(0<=t&&t<n)return t}return e}):[],this.build=t[5]?t[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.`+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{var a=this.prerelease[t],n=e.prerelease[t];if(r("prerelease compare",t,a,n),void 0===a&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===a)return-1;if(a!==n)return l(a,n)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{var a=this.build[t],n=e.build[t];if(r("build compare",t,a,n),void 0===a&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===a)return-1;if(a!==n)return l(a,n)}while(++t)}inc(e,t,a){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,a);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,a);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,a),this.inc("pre",t,a);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,a),this.inc("pre",t,a);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":var n=Number(a)?1:0;if(!t&&!1===a)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[n];else{let e=this.prerelease.length;for(;0<=--e;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);if(-1===e){if(t===this.prerelease.join(".")&&!1===a)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(t){let e=!1===a?[t]:[t,n];(0!==l(this.prerelease[0],t)||isNaN(this.prerelease[1]))&&(this.prerelease=e)}break;default:throw new Error("invalid increment argument: "+e)}return this.raw=this.format(),this.build.length&&(this.raw+="+"+this.build.join(".")),this}};t.exports=c}}),te=e({"node_modules/semver/functions/compare.js"(e,t){var n=ee();t.exports=(e,t,a)=>new n(e,a).compare(new n(t,a))}}),ae=e({"node_modules/semver/functions/gt.js"(e,t){var n=te();t.exports=(e,t,a)=>0<n(e,t,a)}}),e=e({"external-global-plugin:react-dom"(e,t){t.exports=Spicetify.ReactDOM}}),ne={},n=(((e,t)=>{for(var a in t)i(e,a,{get:t[a],enumerable:!0})})(ne,{default:()=>function(){return pt.default.createElement(gt,null)}}),t(a())),re="app-module__full-size-container___XoGtP_eternalDjukebox",ie="app-module__empty-container___Or2XU_eternalDjukebox",oe="app-module__elements-container___Ac4rM_eternalDjukebox",o={container:"main_home_logic-module__container___mF9Nr_eternalDjukebox",title:"main_home_logic-module__title___R4M-H_eternalDjukebox",button:"main_home_logic-module__button___EnnAk_eternalDjukebox",content:"main_home_logic-module__content___8G0KV_eternalDjukebox",stats:"main_home_logic-module__stats___dJo3J_eternalDjukebox"},s=t(a()),se={"jukebox-graph":"media_visualizer-module__jukebox-graph___IrVMr_eternalDjukebox"},l=t(a()),le=t(a());function ce(e){var t;return null==(t=Spicetify.Platform)?void 0:t[e]}function ue(e){let[t,a]=(0,le.useState)(!1);return le.default.createElement("path",{fill:e.drawData.beat.isPlaying||t?e.drawData.activeColor:e.drawData.color,d:e.drawData.drawCommand,onMouseOver:()=>{a(!0)},onMouseOut:()=>{a(!1)},onClick:async()=>{await(e=>{var t=ce(e);if(void 0===t)throw new Error(`Platform API "${e}" is not available`);return t})("PlayerAPI").seekTo(e.drawData.beat.start)}},le.default.createElement("title",null,"Beat ",e.drawData.beat.index))}var he=t(a()),de={"flex-center":"app-module__flex-center___p5IEY_eternalDjukebox","full-size-container":"app-module__full-size-container___XoGtP_eternalDjukebox","empty-container":"app-module__empty-container___Or2XU_eternalDjukebox","elements-container":"app-module__elements-container___Ac4rM_eternalDjukebox"};function me(e){let[t,a]=(0,he.useState)(!1);return he.default.createElement("path",{className:de["edge-path"]+" "+(e.drawData.edge.isPlaying?"is-active":""),fill:"none",stroke:e.drawData.edge.isPlaying||t?e.drawData.activeColor:e.drawData.color,strokeWidth:e.drawData.strokeWidth,d:e.drawData.drawCommand,onMouseOver:e=>{var t;e=e.target,null!=(t=null==(t=document.getElementById("#jukebox-graph"))?void 0:t.firstChild)&&t.appendChild(e),a(!0)},onMouseOut:()=>{a(!1)}},he.default.createElement("title",null,e.drawData.edge.source.index+" - "+e.drawData.edge.destination.index))}function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var be=/^\s+/,ge=/\s+$/;function f(e,t){var a;return t=t||{},(e=e||"")instanceof f?e:this instanceof f?(a=(e=>{var t={r:0,g:0,b:0},a=1,n=null,r=null,i=null,o=!1,s=!1;return"string"==typeof e&&(e=(e=>{e=e.replace(be,"").replace(ge,"").toLowerCase();var t,a=!1;if(De[e])e=De[e],a=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=g.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=g.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=g.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=g.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=g.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=g.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=g.hex8.exec(e))?{r:h(t[1]),g:h(t[2]),b:h(t[3]),a:$e(t[4]),format:a?"name":"hex8"}:(t=g.hex6.exec(e))?{r:h(t[1]),g:h(t[2]),b:h(t[3]),format:a?"name":"hex"}:(t=g.hex4.exec(e))?{r:h(t[1]+""+t[1]),g:h(t[2]+""+t[2]),b:h(t[3]+""+t[3]),a:$e(t[4]+""+t[4]),format:a?"name":"hex8"}:!!(t=g.hex3.exec(e))&&{r:h(t[1]+""+t[1]),g:h(t[2]+""+t[2]),b:h(t[3]+""+t[3]),format:a?"name":"hex"}})(e)),a=Be(a="object"==fe(e)&&(p(e.r)&&p(e.g)&&p(e.b)?(t=((e,t,a)=>({r:255*c(e,255),g:255*c(t,255),b:255*c(a,255)}))(e.r,e.g,e.b),o=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):p(e.h)&&p(e.s)&&p(e.v)?(n=m(e.s),r=m(e.v),t=((e,t,a)=>{e=6*c(e,360),t=c(t,100),a=c(a,100);var n=Math.floor(e),r=a*(1-t),i=a*(1-(e=e-n)*t);return{r:255*[a,i,r,r,e=a*(1-(1-e)*t),a][t=n%6],g:255*[e,a,a,i,r,r][t],b:255*[r,r,e,a,a,i][t]}})(e.h,n,r),o=!0,s="hsv"):p(e.h)&&p(e.s)&&p(e.l)&&(n=m(e.s),i=m(e.l),t=((e,t,a)=>{var n,r,i;function o(e,t,a){return a<0&&(a+=1),1<a&&--a,a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}return e=c(e,360),t=c(t,100),a=c(a,100),0===t?n=r=i=a:(n=o(t=2*a-(a=a<.5?a*(1+t):a+t-a*t),a,e+1/3),r=o(t,a,e),i=o(t,a,e-1/3)),{r:255*n,g:255*r,b:255*i}})(e.h,n,i),o=!0,s="hsl"),e.hasOwnProperty("a"))?e.a:a),{ok:o,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:a}})(e),this._originalInput=e,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||a.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),void(this._ok=a.ok)):new f(e,t)}function pe(e,t,a){e=c(e,255),t=c(t,255),a=c(a,255);var n,r=Math.max(e,t,a),i=Math.min(e,t,a),o=(r+i)/2;if(r==i)n=l=0;else{var s=r-i,l=.5<o?s/(2-r-i):s/(r+i);switch(r){case e:n=(t-a)/s+(t<a?6:0);break;case t:n=(a-e)/s+2;break;case a:n=(e-t)/s+4}n/=6}return{h:n,s:l,l:o}}function Ee(e,t,a){e=c(e,255),t=c(t,255),a=c(a,255);var n,r=Math.max(e,t,a),i=Math.min(e,t,a),o=r,s=r-i,l=0===r?0:s/r;if(r==i)n=0;else{switch(r){case e:n=(t-a)/s+(t<a?6:0);break;case t:n=(a-e)/s+2;break;case a:n=(e-t)/s+4}n/=6}return{h:n,s:l,v:o}}function _e(e,t,a,n){e=[d(Math.round(e).toString(16)),d(Math.round(t).toString(16)),d(Math.round(a).toString(16))];return n&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function ve(e,t,a,n){return[d(Te(n)),d(Math.round(e).toString(16)),d(Math.round(t).toString(16)),d(Math.round(a).toString(16))].join("")}function xe(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.s-=t/100,e.s=u(e.s),f(e)}function ye(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.s+=t/100,e.s=u(e.s),f(e)}function Re(e){return f(e).desaturate(100)}function Ie(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.l+=t/100,e.l=u(e.l),f(e)}function Se(e,t){t=0===t?0:t||10;e=f(e).toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(-t/100*255))),e.g=Math.max(0,Math.min(255,e.g-Math.round(-t/100*255))),e.b=Math.max(0,Math.min(255,e.b-Math.round(-t/100*255))),f(e)}function Ne(e,t){t=0===t?0:t||10;e=f(e).toHsl();return e.l-=t/100,e.l=u(e.l),f(e)}function Ae(e,t){e=f(e).toHsl(),t=(e.h+t)%360;return e.h=t<0?360+t:t,f(e)}function Le(e){e=f(e).toHsl();return e.h=(e.h+180)%360,f(e)}function we(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var a=f(e).toHsl(),n=[f(e)],r=360/t,i=1;i<t;i++)n.push(f({h:(a.h+i*r)%360,s:a.s,l:a.l}));return n}function ke(e){var t=f(e).toHsl(),a=t.h;return[f(e),f({h:(a+72)%360,s:t.s,l:t.l}),f({h:(a+216)%360,s:t.s,l:t.l})]}function Me(e,t,a){t=t||6,a=a||30;var n=f(e).toHsl(),r=360/a,i=[f(e)];for(n.h=(n.h-(r*t>>1)+720)%360;--t;)n.h=(n.h+r)%360,i.push(f(n));return i}function Ce(e,t){t=t||6;for(var e=f(e).toHsv(),a=e.h,n=e.s,r=e.v,i=[],o=1/t;t--;)i.push(f({h:a,s:n,v:r})),r=(r+o)%1;return i}f.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e=this.toRgb(),t=e.r/255,a=e.g/255,e=e.b/255,t=t<=.03928?t/12.92:Math.pow((.055+t)/1.055,2.4),a=a<=.03928?a/12.92:Math.pow((.055+a)/1.055,2.4),e=e<=.03928?e/12.92:Math.pow((.055+e)/1.055,2.4);return.2126*t+.7152*a+.0722*e},setAlpha:function(e){return this._a=Be(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Ee(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Ee(this._r,this._g,this._b),t=Math.round(360*e.h),a=Math.round(100*e.s),e=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+a+"%, "+e+"%)":"hsva("+t+", "+a+"%, "+e+"%, "+this._roundA+")"},toHsl:function(){var e=pe(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=pe(this._r,this._g,this._b),t=Math.round(360*e.h),a=Math.round(100*e.s),e=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+a+"%, "+e+"%)":"hsla("+t+", "+a+"%, "+e+"%, "+this._roundA+")"},toHex:function(e){return _e(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){var t=this._r,a=this._g,n=this._b,r=this._a;return t=[d(Math.round(t).toString(16)),d(Math.round(a).toString(16)),d(Math.round(n).toString(16)),d(Te(r))],e&&t[0].charAt(0)==t[0].charAt(1)&&t[1].charAt(0)==t[1].charAt(1)&&t[2].charAt(0)==t[2].charAt(1)&&t[3].charAt(0)==t[3].charAt(1)?t[0].charAt(0)+t[1].charAt(0)+t[2].charAt(0)+t[3].charAt(0):t.join("")},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*c(this._r,255))+"%",g:Math.round(100*c(this._g,255))+"%",b:Math.round(100*c(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*c(this._r,255))+"%, "+Math.round(100*c(this._g,255))+"%, "+Math.round(100*c(this._b,255))+"%)":"rgba("+Math.round(100*c(this._r,255))+"%, "+Math.round(100*c(this._g,255))+"%, "+Math.round(100*c(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&Oe[_e(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+ve(this._r,this._g,this._b,this._a),a=t;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+t+",endColorstr="+(a=e?"#"+ve((t=f(e))._r,t._g,t._b,t._a):a)+")"},toString:function(e){var t=!!e,a=(e=e||this._format,!1),n=this._a<1&&0<=this._a;return t||!n||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(a=this.toRgbString()),"prgb"===e&&(a=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(a=this.toHexString()),"hex3"===e&&(a=this.toHexString(!0)),"hex4"===e&&(a=this.toHex8String(!0)),"hex8"===e&&(a=this.toHex8String()),"name"===e&&(a=this.toName()),"hsl"===e&&(a=this.toHslString()),(a="hsv"===e?this.toHsvString():a)||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return f(this.toString())},_applyModification:function(e,t){e=e.apply(null,[this].concat([].slice.call(t)));return this._r=e._r,this._g=e._g,this._b=e._b,this.setAlpha(e._a),this},lighten:function(){return this._applyModification(Ie,arguments)},brighten:function(){return this._applyModification(Se,arguments)},darken:function(){return this._applyModification(Ne,arguments)},desaturate:function(){return this._applyModification(xe,arguments)},saturate:function(){return this._applyModification(ye,arguments)},greyscale:function(){return this._applyModification(Re,arguments)},spin:function(){return this._applyModification(Ae,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(Me,arguments)},complement:function(){return this._applyCombination(Le,arguments)},monochromatic:function(){return this._applyCombination(Ce,arguments)},splitcomplement:function(){return this._applyCombination(ke,arguments)},triad:function(){return this._applyCombination(we,[3])},tetrad:function(){return this._applyCombination(we,[4])}},f.fromRatio=function(e,t){if("object"==fe(e)){var a,n={};for(a in e)e.hasOwnProperty(a)&&(n[a]="a"===a?e[a]:m(e[a]));e=n}return f(e,t)},f.equals=function(e,t){return!(!e||!t)&&f(e).toRgbString()==f(t).toRgbString()},f.random=function(){return f.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},f.mix=function(e,t,a){a=0===a?0:a||50;e=f(e).toRgb(),t=f(t).toRgb(),a/=100;return f({r:(t.r-e.r)*a+e.r,g:(t.g-e.g)*a+e.g,b:(t.b-e.b)*a+e.b,a:(t.a-e.a)*a+e.a})},f.readability=function(e,t){e=f(e),t=f(t);return(Math.max(e.getLuminance(),t.getLuminance())+.05)/(Math.min(e.getLuminance(),t.getLuminance())+.05)},f.isReadable=function(e,t,a){var n=f.readability(e,t),r=!1,e=(e=>{var t;return t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),e=(e.size||"small").toLowerCase(),{level:t="AA"!==t&&"AAA"!==t?"AA":t,size:e="small"!==e&&"large"!==e?"small":e}})(a);switch(e.level+e.size){case"AAsmall":case"AAAlarge":r=4.5<=n;break;case"AAlarge":r=3<=n;break;case"AAAsmall":r=7<=n}return r},f.mostReadable=function(e,t,a){for(var n,r=null,i=0,o=(a=a||{}).includeFallbackColors,s=a.level,l=a.size,c=0;c<t.length;c++)i<(n=f.readability(e,t[c]))&&(i=n,r=f(t[c]));return f.isReadable(e,r,{level:s,size:l})||!o?r:(a.includeFallbackColors=!1,f.mostReadable(e,["#fff","#000"],a))};var De=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Oe=f.hexNames=(e=>{var t,a={};for(t in e)e.hasOwnProperty(t)&&(a[e[t]]=t);return a})(De);function Be(e){return e=parseFloat(e),e=isNaN(e)||e<0||1<e?1:e}function c(e,t){"string"==typeof(a=e)&&-1!=a.indexOf(".")&&1===parseFloat(a)&&(e="100%");var a="string"==typeof(a=e)&&-1!=a.indexOf("%");return e=Math.min(t,Math.max(0,parseFloat(e))),a&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function u(e){return Math.min(1,Math.max(0,e))}function h(e){return parseInt(e,16)}function d(e){return 1==e.length?"0"+e:""+e}function m(e){return e=e<=1?100*e+"%":e}function Te(e){return Math.round(255*parseFloat(e)).toString(16)}function $e(e){return h(e)/255}B="[\\s|\\(]+("+(R="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",b="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?";var b,g={CSS_UNIT:new RegExp(R),rgb:new RegExp("rgb"+B),rgba:new RegExp("rgba"+b),hsl:new RegExp("hsl"+B),hsla:new RegExp("hsla"+b),hsv:new RegExp("hsv"+B),hsva:new RegExp("hsva"+b),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function p(e){return g.CSS_UNIT.exec(e)}var E=class{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return this.x+","+this.y}static getMiddlePoint(e,t){return new E((e.x+t.x)/2,(e.y+t.y)/2)}static getDistanceBetweenPoints(e,t){var a=t.x-e.x,t=t.y-e.y;return Math.sqrt(t*t+a*a)}};function _(e,t,a){e=(e=>(e=(e=>e*Math.PI/180)(e),new E(Math.cos(e),Math.sin(e))))(360*e/100);return e.x=e.x*t+a/2,e.y=e.y*-t+a/2,e}var v=100,x=v/2,y=40,je=2,Pe=.2,Fe=1,Ge=x-(y+Fe);function Ue(e){var t,a,n,r,c,u,h,d,m;return 0===e.beats.length?{beats:[],edges:[]}:([t,a]=(e=>{var t,a=[100,100,100],n=[-100,-100,-100];for(t of e.segments)for(let e=0;e<3;e++){var r=t.timbre[e+1];r<a[e]&&(a[e]=r),r>n[e]&&(n[e]=r)}return[a,n]})(e),r=e.beats[0].start,n=e.beats[e.beats.length-1].start+e.beats[e.beats.length-1].duration-r,u=r,h=n,d=t,m=a,{beats:r=(c=e).beats.map(e=>{var t=100*(e.start-u)/h,a=100*e.duration/h,n=Math.min(je+Pe*e.playCount+(e.isPlaying?Fe:0),Ge),n=y+n,r=_(t,n,v),i=_(t+a,n,v),o=_(t,y,v),s=_(t+a,y,v),l=((e,t,a,n)=>{if(null===(t=null!=(e=e.remixedBeats[t.index].firstOverlappingSegment)?e:null))return"#000";var r=t,i=a,o=n,s=[];for(let e=0;e<3;e++){var l=(r.timbre[e+1]-i[e])/(o[e]-i[e]);s[e]=l}return f.fromRatio({r:s[1],g:s[2],b:s[0]}).toHexString()})(c,e,d,m),n=`M ${r.toString()} 
        A ${n},${n} 0 0 0 ${i.toString()}
        L ${s.toString()}
        A ${y},${y} 0 0 1 `+o.toString();return{beat:e,percentFromStart:t,percentOfSong:a,outerArcStart:r,outerArcEnd:i,innerArcStart:o,innerArcEnd:s,drawCommand:n,color:l,activeColor:f(l).complement().saturate(100).toHexString()}}),edges:((e,t)=>{var a,n=[];for(a of e)for(var r of a.beat.neighbours){var i=e[r.source.index],o=e[r.destination.index],s=E.getMiddlePoint(i.innerArcStart,i.innerArcEnd),l=E.getMiddlePoint(o.innerArcStart,o.innerArcEnd),i=E.getDistanceBetweenPoints(i.innerArcStart,i.innerArcEnd),o=E.getDistanceBetweenPoints(o.innerArcStart,o.innerArcEnd),r={edge:r,strokeWidth:Math.min(i,o),drawCommand:`
                        M ${s.toString()}
                        Q ${t},${t} `+l.toString(),color:a.color,activeColor:a.activeColor};n.push(r)}return n})(r,x)})}function He(e){return(0,l.useEffect)(()=>{var e,t=document.querySelector("svg path.is-active");null!==t&&(t=t,null!=(e=null==(e=document.getElementById("#jukebox-graph"))?void 0:e.firstChild))&&e.appendChild(t)}),0===e.state.beats.length?l.default.createElement("div",null,"Loading..."):(e=Ue(e.state),l.default.createElement("svg",{id:"#jukebox-graph",viewBox:`0 0 ${v} `+v,className:se["jukebox-graph"]},l.default.createElement("g",{transform:`scale(-1,1) translate(${-v}, 0) rotate(-90,${x},${x}) `},e.beats.map(e=>l.default.createElement(ue,{key:e.beat.index,drawData:e})),e.edges.map(e=>l.default.createElement(me,{key:e.edge.source.index+"-"+e.edge.destination.index,drawData:e})))))}var Xe,ze,R,qe={"settings-modal":"settings_popup-module__settings-modal___hqRjB_eternalDjukebox","reset-button-container":"settings_popup-module__reset-button-container___BJAuN_eternalDjukebox"},Ve=t(a()),Je=t(a()),We={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},Ye=(Xe="Settings",ze=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],(R=(0,Je.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:r="",children:i,...o},s)=>(0,Je.createElement)("svg",{ref:s,...We,width:t,height:t,stroke:e,strokeWidth:n?24*Number(a)/Number(t):a,className:["lucide","lucide-"+Xe.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),r].join(" "),...o},[...ze.map(([e,t])=>(0,Je.createElement)(e,t)),...Array.isArray(i)?i:[i]]))).displayName=""+Xe,R),Ze={"settings-modal":"settings_popup-module__settings-modal___hqRjB_eternalDjukebox","reset-button-container":"settings_popup-module__reset-button-container___BJAuN_eternalDjukebox"},I=t(a()),S=class{constructor(){this.maxBranchDistance=S.defaultBranchDistance,this.useDynamicBranchDistance=!1,this.minRandomBranchChance=S.defaultMinRandomBranchChance,this.maxRandomBranchChance=S.defaultMaxRandomBranchChance,this.randomBranchChanceDelta=S.defaultRandomBranchChanceDelta,this.maxJukeboxPlayTime=0,this.addLastEdge=!0,this.justBackwards=!1,this.justLongBranches=!1,this.removeSequentialBranches=!1,this.alwaysFollowLastBranch=!0}static fromPartial(e){var t=new S;return t.maxBranchDistance=e.maxBranchDistance,t.useDynamicBranchDistance=e.useDynamicBranchDistance,t.minRandomBranchChance=e.minRandomBranchChance,t.maxRandomBranchChance=e.maxRandomBranchChance,t.randomBranchChanceDelta=e.randomBranchChanceDelta,t.addLastEdge=e.addLastEdge,t.justBackwards=e.justBackwards,t.justLongBranches=e.justLongBranches,t.removeSequentialBranches=e.removeSequentialBranches,t.alwaysFollowLastBranch=e.alwaysFollowLastBranch,t.maxJukeboxPlayTime=e.maxJukeboxPlayTime,t}toPartial(){return{maxBranchDistance:this.maxBranchDistance,useDynamicBranchDistance:this.useDynamicBranchDistance,minRandomBranchChance:this.minRandomBranchChance,maxRandomBranchChance:this.maxRandomBranchChance,randomBranchChanceDelta:this.randomBranchChanceDelta,addLastEdge:this.addLastEdge,justBackwards:this.justBackwards,justLongBranches:this.justLongBranches,removeSequentialBranches:this.removeSequentialBranches,alwaysFollowLastBranch:this.alwaysFollowLastBranch,maxJukeboxPlayTime:this.maxJukeboxPlayTime}}},N=S,Qe=(N.minBeatsBeforeBranching=5,N.rangeMinBranchDistance=2,N.rangeMaxBranchDistance=80,N.defaultBranchDistance=30,N.defaultMinRandomBranchChance=.18,N.defaultMaxRandomBranchChance=.5,N.minRandomBranchChanceDelta=0,N.maxRandomBranchChanceDelta=.2,N.defaultRandomBranchChanceDelta=.018,class{static get settings(){return N.fromPartial(Qe.storedSettings)}static set settings(e){Qe.storedSettings=e.toPartial()}static get storedSettings(){var e=Spicetify.LocalStorage.get(this.settingId);return null==e?(new N).toPartial():JSON.parse(e)}static set storedSettings(e){Spicetify.LocalStorage.set(this.settingId,JSON.stringify(e))}}),Ke=Qe,A=(Ke.settingId="jukebox:settings",{container:"MultiRangeSlider-module__container___0nUBJ_eternalDjukebox",slider:"MultiRangeSlider-module__slider___5peYR_eternalDjukebox",slider__track:"MultiRangeSlider-module__slider__track___BDp82_eternalDjukebox",slider__range:"MultiRangeSlider-module__slider__range___e8Dfy_eternalDjukebox",thumb:"MultiRangeSlider-module__thumb___zWXZm_eternalDjukebox","thumb--zindex-3":"MultiRangeSlider-module__thumb--zindex-3___jgUmd_eternalDjukebox","thumb--zindex-4":"MultiRangeSlider-module__thumb--zindex-4___IgwQ2_eternalDjukebox","thumb--zindex-5":"MultiRangeSlider-module__thumb--zindex-5___PV7-6_eternalDjukebox"}),L=t(a());function et(t){let[a,n]=(0,L.useState)(t.minDefaultValue),[r,i]=(0,L.useState)(t.maxDefaultValue),o=(0,L.useRef)(null),s=(0,L.useRef)(null),l=(0,L.useRef)(null),c=(0,L.useCallback)(e=>Math.round((e-t.min)/(t.max-t.min)*100),[t.min,t.max]);return(0,L.useEffect)(()=>{var e,t;s.current&&(e=c(a),t=c(s.current.valueAsNumber),l.current)&&(l.current.style.left=e+"%",l.current.style.width=t-e+"%")},[a,c]),(0,L.useEffect)(()=>{var e,t;o.current&&(e=c(o.current.valueAsNumber),t=c(r),l.current)&&(l.current.style.width=t-e+"%")},[r,c]),(0,L.useEffect)(()=>{t.onChange({min:a,max:r})},[a,r,t.onChange]),L.default.createElement("div",{className:A.container},L.default.createElement("input",{type:"range",min:t.min,max:t.max,value:a,ref:o,onChange:e=>{var t=Math.min(e.target.valueAsNumber,r-1);n(t),e.target.value=t.toString()},className:A.thumb+" "+A["thumb--zindex-3"]+(a>t.max-10*t.max/100?" "+A["thumb--zindex-5"]:"")}),L.default.createElement("input",{type:"range",min:t.min,max:t.max,value:r,ref:s,onChange:e=>{var t=Math.max(e.target.valueAsNumber,a+1);i(t),e.target.value=t.toString()},className:A.thumb+" "+A["thumb--zindex-4"]}),L.default.createElement("div",{className:A.slider},L.default.createElement("div",{className:A.slider__track}),L.default.createElement("div",{ref:l,className:A.slider__range})))}var tt=t(a());function w(e){var{elementType:t="span",children:a}=e,n=V(e,["elementType","children"]);let r;switch(t){case"h1":r=Spicetify.ReactComponent.TextComponent.h1;break;case"h2":r=Spicetify.ReactComponent.TextComponent.h2;break;case"h3":r=Spicetify.ReactComponent.TextComponent.h3;break;case"h4":r=Spicetify.ReactComponent.TextComponent.h4;break;case"h5":r=Spicetify.ReactComponent.TextComponent.h5;break;case"h6":r=Spicetify.ReactComponent.TextComponent.h6;break;case"li":r=Spicetify.ReactComponent.TextComponent.li;break;case"p":r=Spicetify.ReactComponent.TextComponent.p;break;case"small":r=Spicetify.ReactComponent.TextComponent.small;break;case"span":r=Spicetify.ReactComponent.TextComponent.span;break;default:r=Spicetify.ReactComponent.TextComponent}return tt.default.createElement(r,q(z({},n),{style:e.style}),a)}var k=t(a());function at(t){return k.default.createElement("label",{className:"x-toggle-wrapper"},k.default.createElement("input",{id:t.inputId,className:"x-toggle-input",type:"checkbox",checked:t.value,onChange:e=>{t.onChange(!t.value)}}),k.default.createElement("span",{className:"x-toggle-indicatorWrapper"},k.default.createElement("span",{className:"x-toggle-indicator"})))}var nt={"checkbox-container":"CheckboxContainer-module__checkbox-container___1OZ2C_eternalDjukebox"},M=t(a());function C(e){return M.default.createElement("div",{className:nt["checkbox-container"]},M.default.createElement("div",null,M.default.createElement(w,{elementType:"h3",variant:"violaBold"},e.label),M.default.createElement(w,{elementType:"small",semanticColor:"textSubdued"},e.subLabel)),M.default.createElement(at,{inputId:e.inputId,value:e.value,onChange:e.onChange}))}var rt={"range-subtext":"SliderContainer-module__range-subtext___eeuMo_eternalDjukebox"},D=t(a());function it(e){return D.default.createElement("div",{style:z({width:e.containerWidth},e.style)},D.default.createElement("div",null,D.default.createElement(w,{elementType:"h3",variant:"violaBold"},e.label),D.default.createElement(w,{style:{display:"block"},elementType:"small",semanticColor:"textSubdued",paddingBottom:"8px"},e.subLabel)),e.slider,D.default.createElement("div",{className:rt["range-subtext"]},D.default.createElement(w,{elementType:"small",semanticColor:"textSubdued"},e.minLabel),D.default.createElement(w,{elementType:"small",semanticColor:"textSubdued"},e.maxLabel)))}function ot(){let[e,n]=(0,I.useState)(Ke.storedSettings);function a(t,a){if(typeof a!=typeof e[t])throw new Error("Value type does not match field type");e[t]!==a&&n(e=>q(z({},e),{[t]:a}))}return(0,I.useEffect)(()=>{let n=new MutationObserver(e=>{let t=!1;for(var a of e)a.removedNodes.forEach(e=>{"GENERIC-MODAL"===e.nodeName&&(t=!0)});t&&(window.jukebox.reloadSettings().catch(console.error),n.disconnect())});n.observe(document.getElementsByTagName("body")[0],{childList:!0})},[]),(0,I.useEffect)(()=>{Ke.storedSettings=e},[e]),I.default.createElement("div",{className:Ze["settings-modal"]},I.default.createElement(it,{label:"Branch Similarity Threshold: "+e.maxBranchDistance,subLabel:"The maximum similarity distance allowed between two beats in order to create a branch.",slider:I.default.createElement("input",{id:"jukebox.settings.maxBranchDistance",type:"range",min:N.rangeMinBranchDistance,max:N.rangeMaxBranchDistance,value:e.maxBranchDistance,step:1,onChange:e=>{a("maxBranchDistance",e.target.valueAsNumber)},disabled:e.useDynamicBranchDistance}),minLabel:"Higher quality",maxLabel:"More branches",style:{opacity:e.useDynamicBranchDistance?.5:1}}),I.default.createElement(C,{inputId:"jukebox.settings.useDynamicBranchDistance",label:"Use dynamic branch distance",subLabel:"If checked, will calculate the branch similarity threshold automatically to try to get as many quality branch as possible.",value:e.useDynamicBranchDistance,onChange:e=>{a("useDynamicBranchDistance",e)}}),I.default.createElement(it,{label:`Branch Probability Range: ${Math.round(100*e.minRandomBranchChance)}% to 
                ${Math.round(100*e.maxRandomBranchChance)}%`,subLabel:"The minimum and maximum chance for a branch to be selected each beat.",slider:I.default.createElement(et,{min:0,max:100,minDefaultValue:100*e.minRandomBranchChance,maxDefaultValue:100*e.maxRandomBranchChance,onChange:({min:e,max:t})=>{a("minRandomBranchChance",e/100),a("maxRandomBranchChance",t/100)}}),minLabel:"Low",maxLabel:"High"}),I.default.createElement(it,{label:`Branch Probability Ramp-up Speed: ${Math.round(100*e.randomBranchChanceDelta)}%`,subLabel:"Controls how fast the chance to select a branch will increase.",slider:I.default.createElement("input",{id:"jukebox.settings.randomBranchChanceDelta",type:"range",min:0,max:100,value:100*e.randomBranchChanceDelta,step:2,onChange:e=>{a("randomBranchChanceDelta",e.target.valueAsNumber/100)}}),minLabel:"Slow",maxLabel:"Fast"}),I.default.createElement(C,{inputId:"jukebox.settings.addLastEdge",label:"Loop extension optimization",subLabel:"If checked, optimize by adding a good last edge.",value:e.addLastEdge,onChange:e=>{a("addLastEdge",e)}}),I.default.createElement(C,{inputId:"jukebox.settings.justBackwards",label:"Allow only backward branches",subLabel:"If checked, only add backward branches.",value:e.justBackwards,onChange:e=>{a("justBackwards",e)}}),I.default.createElement(C,{inputId:"jukebox.settings.justLongBranches",label:"Allow only long branches",subLabel:"If checked, only add long branches.",value:e.justLongBranches,onChange:e=>{a("justLongBranches",e)}}),I.default.createElement(C,{inputId:"jukebox.settings.removeSequentialBranches",label:"Remove sequential branches",subLabel:"If checked, remove consecutive branches of the same distance.",value:e.removeSequentialBranches,onChange:e=>{a("removeSequentialBranches",e)}}),I.default.createElement(C,{inputId:"jukebox.settings.alwaysFollowLastBranch",label:"Always follow the last branch",subLabel:"If checked, always follow the last possible branch. Note that setting this to false will result in songs not looping indefinitely.",value:e.alwaysFollowLastBranch,onChange:e=>{a("alwaysFollowLastBranch",e)}}),I.default.createElement("div",null,I.default.createElement(w,{elementType:"h3",variant:"violaBold"},"Maximum play time for a song, in seconds"),I.default.createElement(w,{elementType:"p",semanticColor:"textSubdued"},"After the listen time reaches this value, the jukebox will stop branching and continue to the next song where it will activate again. Set this to 0 for no limit."),I.default.createElement("input",{type:"number",className:"x-settings-input",style:{marginTop:"1rem"},id:"jukebox.settings.maxJukeboxPlayTime",value:e.maxJukeboxPlayTime/1e3,onChange:e=>{a("maxJukeboxPlayTime",1e3*e.target.valueAsNumber)}})),I.default.createElement("div",{className:Ze["reset-button-container"]},I.default.createElement(Spicetify.ReactComponent.ButtonPrimary,{buttonSize:"sm",onClick:function(){n((new N).toPartial())}},"Reset")))}function st(){return Ve.default.createElement("button",{className:qe["settings-button"],onClick:e=>{Spicetify.PopupModal.display({title:"Jukebox settings",content:Ve.default.createElement(ot),isLarge:!0})},style:{height:"50px",width:"50px",borderRadius:"15px"}},Ve.default.createElement(Ye,{stroke:"currentColor",size:20}))}function lt(){let[e,a]=(0,s.useState)({trackName:"",artistName:""}),[t,n]=(0,s.useState)({beats:[],remixedBeats:[],segments:[]}),[r,i]=(0,s.useState)({beatsPlayed:0,listenTime:"0",currentRandomBranchChance:0});return(0,s.useEffect)(()=>{let e=window.jukebox.songState$.subscribe(e=>{var t;a({trackName:null!=(t=null==(t=null==(t=null==e?void 0:e.track)?void 0:t.metadata)?void 0:t.title)?t:"",artistName:null!=(t=null==(t=null==(t=null==e?void 0:e.track)?void 0:t.metadata)?void 0:t.artist_name)?t:""}),n({beats:null!=(t=null==e?void 0:e.graph.beats)?t:[],segments:null!=(t=null==e?void 0:e.analysis.segments)?t:[],remixedBeats:null!=(t=null==e?void 0:e.analysis.beats)?t:[]})});return()=>{e.unsubscribe()}},[]),(0,s.useEffect)(()=>{let e=window.jukebox.statsChanged$.subscribe(e=>{var t;i({beatsPlayed:e.beatsPlayed,currentRandomBranchChance:100*e.currentRandomBranchChance,listenTime:(e=e.listenTime,t=Math.floor(e/6e4),60===(e=Math.floor(e%6e4/1e3))?t+1+":00":t+":"+(e<10?"0":"")+e)})});return()=>{e.unsubscribe()}},[]),s.default.createElement("div",{className:o.container},s.default.createElement("div",{className:o.title},s.default.createElement("h1",null,e.trackName),s.default.createElement("p",null,"by"),s.default.createElement("h2",null,e.artistName)),s.default.createElement("div",{className:o.button},s.default.createElement(st,null)),s.default.createElement("div",{className:o.content},s.default.createElement(He,{state:t})),s.default.createElement("div",{className:o.stats},s.default.createElement("span",null,"Total Beats: "+r.beatsPlayed),s.default.createElement("span",null,`Current branch change: ${Math.round(r.currentRandomBranchChance)}%`),s.default.createElement("span",null,"Listen Time: "+r.listenTime)))}var ct=t(ae()),ut=t(e());var ht=async function(t,a,e){for(;!Spicetify?.PopupModal||!Spicetify?.LocalStorage;)await new Promise(e=>setTimeout(e,100));var n,t=`spcr-whats-new_${t}-version`,r=Spicetify.LocalStorage.get(t)??"";try{(0,ct.default)(a,r)&&(Spicetify.LocalStorage.set(t,a),n={...e,content:(e=>{var t=document.createElement("div"),a=(t.setAttribute("id","whats-new-content-wrapper"),document.createElement("style"));return a.textContent=`
      #whats-new-content-wrapper ul, #whats-new-content-wrapper ol {
         list-style: inherit;
         margin-left: 1em;
      }
   `,ut.default.render(e,t),t.appendChild(a),t})(e.content)},Spicetify.PopupModal.display(n))}catch(e){Spicetify.LocalStorage.set(t,a)}},dt=['Fix "No analysis available for this track".'],O=t(a(),1),mt=(()=>"undefined"==typeof window?O.useEffect:O.useLayoutEffect)(),ft=e=>e[1]?.next?e[1]:{next:e[1],error:e[2],complete:e[3]};function bt(e,t,i,o){{var s=O.useEffect,l=[e,t,i,o];let a=(0,O.useRef)(l),n=(0,O.useRef)(),r=(0,O.useRef)();mt(()=>{a.current=l,n.current=ft(l)}),s(()=>{let t=a.current[0],e=(n.current||(n.current=ft(a.current)),t.subscribe({next:e=>{t===a.current[0]&&n.current.next?.(e)},error:e=>{t===a.current[0]&&(n.current.error?n.current:console).error(e)},complete:()=>{t===a.current[0]&&n.current.complete?.()}}));return r.current=e,()=>{e.unsubscribe()}},[l[0]]),r}}var B,gt=function(){var[e,t]=(0,n.useState)(null);return bt(window.jukebox.songState$,t),(0,n.useEffect)(()=>{(async()=>{await ht("eternal-jukebox","0.1.0",{title:"New in v0.1.0",content:n.default.createElement("p",null,n.default.createElement("ul",null,dt.map(e=>n.default.createElement("li",{key:e},e)))),isLarge:!0})})()},[]),window.jukebox.isEnabled?null!==e?n.default.createElement("div",{className:re},n.default.createElement(lt,null)):n.default.createElement("div",{className:ie},n.default.createElement("div",{className:oe},n.default.createElement(st,null),n.default.createElement("div",null,n.default.createElement("h1",null,"Loading...")))):n.default.createElement("div",{className:ie},n.default.createElement("div",{className:oe},n.default.createElement(st,null),n.default.createElement("div",null,n.default.createElement("h1",null,"Jukebox not enabled."))))},pt=t(a());return B=ne,J(i({},"__esModule",{value:!0}),B)})();let render=()=>eternalDjukebox.default();